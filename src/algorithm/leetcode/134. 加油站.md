---
date: 2025-08-14
author: Gaaming Zhang
isOriginal: true
article: true
category: leetcode
tag:
  - leetcode
  - 贪心算法
---

# 134. 加油站

在一条环路上有 n 个加油站，其中第 i 个加油站有汽油 gas[i] 升。
你有一辆油箱容量无限的的汽车，从第 i 个加油站开往第 i+1 个加油站需要消耗汽油 cost[i] 升。
你从其中的一个加油站出发，开始时油箱为空。
给定两个整数数组 gas 和 cost ，如果你可以按顺序绕环路行驶一周，则返回出发时加油站的编号，
 否则返回 -1 。如果存在解，则 保证 它是 唯一 的。

示例 1:
输入: gas = [1,2,3,4,5], cost = [3,4,5,1,2]
输出：3
解释:
从 3 号加油站(索引为 3 处)出发，可获得 4 升汽油。此时油箱有 = 0 + 4 = 4 升汽油
开往 4 号加油站，此时油箱有 4 - 1 + 5 = 8 升汽油
开往 0 号加油站，此时油箱有 8 - 2 + 1 = 7 升汽油
开往 1 号加油站，此时油箱有 7 - 3 + 2 = 6 升汽油
开往 2 号加油站，此时油箱有 6 - 4 + 3 = 5 升汽油
开往 3 号加油站，你需要消耗 5 升汽油，正好足够你返回到 3 号加油站。
因此，3 可为起始索引。

## 解题思路

这道题需要找到能够绕环路行驶一周的起始加油站。

### 贪心算法

核心思路：**如果从某个加油站出发无法到达下一个加油站，那么从这之间的任何加油站出发都无法完成**。

### 关键洞察

1. 如果总油量 < 总消耗，则无解
2. 如果从 i 出发到 j 时油量不足，则 i 到 j 之间的任何加油站都不能作为起点
3. 可以直接跳到 j+1 作为新的起点尝试

### 算法流程

1. 从第一个加油站开始尝试
2. 计算当前油量，如果油量不足，跳到下一个可能的起点
3. 如果能绕一圈，返回起点索引

### 优化原理

假设从 i 出发，到达 j 时油量不足。那么从 i 到 j 之间的任何 k 出发，到达 j 时油量一定也不足（因为从 i 到 k 已经消耗了部分油量）。所以可以直接跳到 j+1 继续尝试。

## 代码实现

```cpp
class Solution {
public:
    int canCompleteCircuit(vector<int>& gas, vector<int>& cost) {
        int index = 0;  // 起始加油站索引
        int n = gas.size();
        
        while (index < n) {
            int count = 0;  // 已经过的加油站数量
            int val = 0;    // 当前油量
            
            // 尝试绕一圈
            while (count < n) {
                // 加油
                val += gas[(index + count) % n];
                // 消耗
                val -= cost[(index + count) % n];
                
                // 油量不足，无法继续
                if (val < 0) {
                    break;
                }
                ++count;
            }
            
            // 成功绕一圈
            if (count == n) {
                return index;
            }
            
            // 跳到下一个可能的起点
            // 从 index 到 index+count 之间的任何加油站都不能作为起点
            index = index + count + 1;
        }
        
        return -1;  // 无解
    }
};
```

## 复杂度分析

- **时间复杂度**：O(n)，虽然有两层循环，但每个加油站最多被访问一次。
- **空间复杂度**：O(1)，只使用了常数级别的额外空间。

## 总结

本题使用**贪心算法**优化暴力解法。关键在于：

1. **跳跃优化**：如果从 i 出发到 j 失败，则 i 到 j 之间的所有加油站都不能作为起点
2. **时间复杂度优化**：从 O(n²) 优化到 O(n)
3. **唯一解保证**：题目保证如果有解，则解唯一

这道题的难点在于理解为什么可以跳跃，核心思想是利用已经计算过的信息避免重复计算。
